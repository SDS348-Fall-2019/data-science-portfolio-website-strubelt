"0","library(plotROC)"
"0","Ricci$Position<-ifelse(Ricci$Position==""Captain"",1,0)"
"0","fit3<-glm(Position~Race+Oral+Written,data = Ricci,family = binomial(link = ""logit""))"
"0","coeftest(fit3)"
"1","
z test of coefficients:

"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," z value"
"1","
(Intercept)"
"1"," -2.908069"
"1","   1.611023"
"1"," -1.8051"
"1","
RaceH      "
"1","  0.748824"
"1","   0.674183"
"1","  1.1107"
"1","
RaceW      "
"1","  0.298058"
"1","   0.564007"
"1","  0.5285"
"1","
Oral       "
"1","  0.051282"
"1","   0.019162"
"1","  2.6762"
"1","
Written    "
"1"," -0.020184"
"1","   0.022498"
"1"," -0.8972"
"1","
"
"1","           "
"1"," Pr(>|z|)"
"1","   "
"1","
(Intercept)"
"1"," 0.071058"
"1"," . "
"1","
RaceH      "
"1"," 0.266691"
"1","   "
"1","
RaceW      "
"1"," 0.597177"
"1","   "
"1","
Oral       "
"1"," 0.007446"
"1"," **"
"1","
Written    "
"1"," 0.369636"
"1","   "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","
"
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"0","#Oral is significant meaning that it increases the log-odds of Position. So i am assuming the better verbal skills these people have makes them more likely to be in a certain position."
"0","probs<-predict(fit3,type=""response"")"
"0","mean(probs>.99)"
"1","[1]"
"1"," 0"
"1","
"
"0","class_diag<-function(probs,truth){"
"0"," tab<-table(factor(probs>.5,levels=c(""FALSE"",""TRUE"")),truth)"
"0"," acc=sum(diag(tab))/sum(tab)"
"0"," sens=tab[2,2]/colSums(tab)[2]"
"0"," spec=tab[1,1]/colSums(tab)[1]"
"0"," ppv=tab[2,2]/rowSums(tab)[2]"
"0"," if(is.numeric(truth)==FALSE & is.logical(truth)==FALSE) truth<-as.numeric(truth)-1"
"0"," ord<-order(probs, decreasing=TRUE)"
"0"," probs <- probs[ord]; truth <- truth[ord]"
"0"," TPR=cumsum(truth)/max(1,sum(truth))"
"0"," FPR=cumsum(!truth)/max(1,sum(!truth))"
"0"," dup<-c(probs[-1]>=probs[-length(probs)], FALSE)"
"0"," TPR<-c(0,TPR[!dup],1); FPR<-c(0,FPR[!dup],1)"
"0"," n <- length(TPR)"
"0"," auc<- sum( ((TPR[-1]+TPR[-n])/2) * (FPR[-1]-FPR[-n]) )"
"0"," data.frame(acc,sens,spec,ppv,auc)"
"0","} "
"0","class_diag(probs,Ricci$Position)"
