"0","summary(worlddata)"
"1",""
"1"," beer_servings  "
"1"," spirit_servings "
"1","
"
"1"," Min.   :  0.0  "
"1"," Min.   :  0.00  "
"1","
"
"1"," 1st Qu.: 20.0  "
"1"," 1st Qu.:  6.00  "
"1","
"
"1"," Median : 77.0  "
"1"," Median : 67.00  "
"1","
"
"1"," Mean   :110.3  "
"1"," Mean   : 78.72  "
"1","
"
"1"," 3rd Qu.:193.5  "
"1"," 3rd Qu.:122.00  "
"1","
"
"1"," Max.   :361.0  "
"1"," Max.   :373.00  "
"1","
"
"1",""
"1"," wine_servings   "
"1"," total_litres_of_pure_alcohol"
"1","
"
"1"," Min.   :  0.00  "
"1"," Min.   : 0.000              "
"1","
"
"1"," 1st Qu.:  1.00  "
"1"," 1st Qu.: 1.350              "
"1","
"
"1"," Median :  9.00  "
"1"," Median : 4.700              "
"1","
"
"1"," Mean   : 55.58  "
"1"," Mean   : 4.956              "
"1","
"
"1"," 3rd Qu.: 85.00  "
"1"," 3rd Qu.: 8.200              "
"1","
"
"1"," Max.   :370.00  "
"1"," Max.   :14.400              "
"1","
"
"1",""
"1","   Country         "
"1","    Region         "
"1","
"
"1"," Length:147        "
"1"," Length:147        "
"1","
"
"1"," Class :character  "
"1"," Class :character  "
"1","
"
"1"," Mode  :character  "
"1"," Mode  :character  "
"1","
"
"1","                   "
"1","                   "
"1","
"
"1","                   "
"1","                   "
"1","
"
"1","                   "
"1","                   "
"1","
"
"1",""
"1"," Happiness Rank  "
"1"," Happiness Score"
"1","
"
"1"," Min.   :  1.00  "
"1"," Min.   :2.839  "
"1","
"
"1"," 1st Qu.: 38.00  "
"1"," 1st Qu.:4.534  "
"1","
"
"1"," Median : 79.00  "
"1"," Median :5.253  "
"1","
"
"1"," Mean   : 78.54  "
"1"," Mean   :5.399  "
"1","
"
"1"," 3rd Qu.:118.50  "
"1"," 3rd Qu.:6.298  "
"1","
"
"1"," Max.   :158.00  "
"1"," Max.   :7.587  "
"1","
"
"1",""
"1"," Economy (GDP per Capita)"
"1","     Family      "
"1","
"
"1"," Min.   :0.0153          "
"1"," Min.   :0.0000  "
"1","
"
"1"," 1st Qu.:0.5460          "
"1"," 1st Qu.:0.8580  "
"1","
"
"1"," Median :0.9186          "
"1"," Median :1.0352  "
"1","
"
"1"," Mean   :0.8510          "
"1"," Mean   :0.9939  "
"1","
"
"1"," 3rd Qu.:1.1570          "
"1"," 3rd Qu.:1.2218  "
"1","
"
"1"," Max.   :1.6904          "
"1"," Max.   :1.4022  "
"1","
"
"1",""
"1"," Health (Life Expectancy)"
"1","    Freedom      "
"1","
"
"1"," Min.   :0.0000          "
"1"," Min.   :0.0000  "
"1","
"
"1"," 1st Qu.:0.4539          "
"1"," 1st Qu.:0.3304  "
"1","
"
"1"," Median :0.6980          "
"1"," Median :0.4402  "
"1","
"
"1"," Mean   :0.6328          "
"1"," Mean   :0.4334  "
"1","
"
"1"," 3rd Qu.:0.8104          "
"1"," 3rd Qu.:0.5549  "
"1","
"
"1"," Max.   :1.0252          "
"1"," Max.   :0.6697  "
"1","
"
"0","#removing the Happiness Rank variable due to the fact that it is exactly the same as the Happiness"
"0","#Score but it numbers the countries based on their score."
"0","worlddata%>%select(-`Happiness Rank`)->revisedworlddata"
"0",""
"0","worlddata_nums<-revisedworlddata%>%select_if(is.numeric)%>%scale"
"0",""
"0","rownames(worlddata_nums)<-revisedworlddata$Country"
"0",""
"0","worlddata_pca<-princomp(worlddata_nums)"
"0",""
"0","names(worlddata_pca)"
"1","[1]"
"1"," ""sdev""    "
"1"," ""loadings"""
"1"," ""center""  "
"1"," ""scale""   "
"1","
"
"1","[5]"
"1"," ""n.obs""   "
"1"," ""scores""  "
"1"," ""call""    "
"1","
"
"0","summary(worlddata_pca,loadings = T)"
"1","Importance of components:
"
"1","                      "
"1","    Comp.1"
"1","    Comp.2"
"1","
Standard deviation    "
"1"," 2.2384627"
"1"," 1.1396351"
"1","
Proportion of Variance"
"1"," 0.5605595"
"1"," 0.1452960"
"1","
Cumulative Proportion "
"1"," 0.5605595"
"1"," 0.7058555"
"1","
"
"1","                      "
"1","     Comp.3"
"1","     Comp.4"
"1","
Standard deviation    "
"1"," 0.88087282"
"1"," 0.84264687"
"1","
Proportion of Variance"
"1"," 0.08680573"
"1"," 0.07943524"
"1","
Cumulative Proportion "
"1"," 0.79266119"
"1"," 0.87209643"
"1","
"
"1","                      "
"1","     Comp.5"
"1","     Comp.6"
"1","
Standard deviation    "
"1"," 0.67154827"
"1"," 0.55243516"
"1","
Proportion of Variance"
"1"," 0.05045177"
"1"," 0.03414166"
"1","
Cumulative Proportion "
"1"," 0.92254820"
"1"," 0.95668986"
"1","
"
"1","                      "
"1","     Comp.7"
"1","    Comp.8"
"1","
Standard deviation    "
"1"," 0.39669424"
"1"," 0.3880060"
"1","
Proportion of Variance"
"1"," 0.01760491"
"1"," 0.0168422"
"1","
Cumulative Proportion "
"1"," 0.97429477"
"1"," 0.9911370"
"1","
"
"1","                      "
"1","      Comp.9"
"1","
Standard deviation    "
"1"," 0.281468764"
"1","
Proportion of Variance"
"1"," 0.008863033"
"1","
Cumulative Proportion "
"1"," 1.000000000"
"1","
"
"1","
Loadings:
"
"1","                            "
"1"," Comp.1"
"1"," Comp.2"
"1","
beer_servings               "
"1","  0.352"
"1","  0.340"
"1","
spirit_servings             "
"1","  0.255"
"1","  0.409"
"1","
wine_servings               "
"1","  0.311"
"1","  0.187"
"1","
total_litres_of_pure_alcohol"
"1","  0.353"
"1","  0.461"
"1","
Happiness Score             "
"1","  0.374"
"1"," -0.357"
"1","
Economy (GDP per Capita)    "
"1","  0.377"
"1"," -0.205"
"1","
Family                      "
"1","  0.357"
"1"," -0.142"
"1","
Health (Life Expectancy)    "
"1","  0.357"
"1"," -0.200"
"1","
Freedom                     "
"1","  0.229"
"1"," -0.490"
"1","
"
"1","                            "
"1"," Comp.3"
"1"," Comp.4"
"1","
beer_servings               "
"1","  0.107"
"1","  0.241"
"1","
spirit_servings             "
"1"," -0.671"
"1","       "
"1","
wine_servings               "
"1","  0.681"
"1","       "
"1","
total_litres_of_pure_alcohol"
"1","       "
"1","  0.223"
"1","
Happiness Score             "
"1","       "
"1","       "
"1","
Economy (GDP per Capita)    "
"1","       "
"1"," -0.409"
"1","
Family                      "
"1"," -0.240"
"1","  0.161"
"1","
Health (Life Expectancy)    "
"1","       "
"1"," -0.497"
"1","
Freedom                     "
"1","       "
"1","  0.667"
"1","
"
"1","                            "
"1"," Comp.5"
"1"," Comp.6"
"1","
beer_servings               "
"1","  0.227"
"1","  0.651"
"1","
spirit_servings             "
"1"," -0.402"
"1"," -0.213"
"1","
wine_servings               "
"1"," -0.210"
"1"," -0.478"
"1","
total_litres_of_pure_alcohol"
"1","       "
"1","       "
"1","
Happiness Score             "
"1","  0.155"
"1","       "
"1","
Economy (GDP per Capita)    "
"1","  0.114"
"1","  0.180"
"1","
Family                      "
"1","  0.612"
"1"," -0.495"
"1","
Health (Life Expectancy)    "
"1"," -0.349"
"1","  0.128"
"1","
Freedom                     "
"1"," -0.458"
"1","       "
"1","
"
"1","                            "
"1"," Comp.7"
"1"," Comp.8"
"1","
beer_servings               "
"1","  0.164"
"1","  0.113"
"1","
spirit_servings             "
"1"," -0.166"
"1","       "
"1","
wine_servings               "
"1"," -0.114"
"1","       "
"1","
total_litres_of_pure_alcohol"
"1","       "
"1","       "
"1","
Happiness Score             "
"1"," -0.678"
"1","  0.483"
"1","
Economy (GDP per Capita)    "
"1"," -0.159"
"1"," -0.760"
"1","
Family                      "
"1","  0.381"
"1","       "
"1","
Health (Life Expectancy)    "
"1","  0.536"
"1","  0.363"
"1","
Freedom                     "
"1","  0.112"
"1"," -0.196"
"1","
"
"1","                            "
"1"," Comp.9"
"1","
beer_servings               "
"1","  0.419"
"1","
spirit_servings             "
"1","  0.279"
"1","
wine_servings               "
"1","  0.339"
"1","
total_litres_of_pure_alcohol"
"1"," -0.772"
"1","
Happiness Score             "
"1","       "
"1","
Economy (GDP per Capita)    "
"1","       "
"1","
Family                      "
"1","       "
"1","
Health (Life Expectancy)    "
"1"," -0.168"
"1","
Freedom                     "
"1","       "
"1","
"
"0","eigval<-worlddata_pca$sdev^2"
"0",""
"0","#Going to use the first two PC because their eigenvalues are greater than 1 (Kaiser's rule)"
"0","eigval"
"1","    Comp.1 "
"1","    Comp.2 "
"1","    Comp.3 "
"1","    Comp.4 "
"1","
"
"1","5.01071530 "
"1","1.29876822 "
"1","0.77593693 "
"1","0.71005374 "
"1","
"
"1","    Comp.5 "
"1","    Comp.6 "
"1","    Comp.7 "
"1","    Comp.8 "
"1","
"
"1","0.45097708 "
"1","0.30518460 "
"1","0.15736632 "
"1","0.15054866 "
"1","
"
"1","    Comp.9 "
"1","
"
"1","0.07922467 "
"1","
"
"0","#This allows for me to note that PC2 involves some kind of trade off with Freedom and Spirit"
"0","#Servings. Countries that have lower spirit servings tend to have a higher since of freedom and vice"
"0","#versa"
"0","#For PC1 i am going to assume it is GDP and Freedom since they are the most separted from each other."
"0","worlddata_pca$loadings[1:9,1:2]%>%as.data.frame%>%rownames_to_column%>%"
"0","ggplot()+geom_hline(aes(yintercept=0),lty=2)+"
"0"," geom_vline(aes(xintercept=0),lty=2)+ylab(""PC2"")+xlab(""PC1"")+"
"0"," geom_segment(aes(x=0,y=0,xend=Comp.1,yend=Comp.2),arrow=arrow(),col=""red"")+"
"0"," geom_label(aes(x=Comp.1*1.1,y=Comp.2*1.1,label=rowname))"
